<html>
    <head>
        <title>Project 2</title>
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <style> svg { border: solid #ccc 1px; } </style>
    </head>

    <body>
        <h2>F1 Race Results</h2>
        <h3>Races</h3>
        <svg id="Races" width="1600" height="50">
        </svg>
        <br>
        <svg id="Graph" width="1600" height="800">
        </svg>
        <script>
            //List of Races in F1 2011
            var race_list = ["Belgium","Canada","EUGP","Germany","Hungary","India","Italy","Japan","Korea","Monaco","Silverstone","Singapore","Spain"]
            
            //Load Data Files
            var race_data
            
            var queue = d3.queue();
            race_list.forEach(function(race_name){
                //Queue all data files
                queue.defer(d3.json, "RaceData_JSON/"+race_name+".json")
            });
            queue.awaitAll(function (error, race_jsons){
                race_data = race_jsons;
                //Name all races
                for (i=0; i<race_list.length; i++){
                    race_data[i].name = race_list[i];
                }  
            });
            
            
            
            //TO DO initializeRace
            //
            // Called from "on click" event of a button
            // Creates graph of clicked race with top 3 finishers selected
            // Removes old graph stuff
            // Creates clickable buttons for each racer
            
            
            
            
            //Create Race Buttons        
            var buttons = [];
            var race_tabs = d3.select("#Races");
            var tabsScale = d3.scaleLinear()
                                .domain([0,race_list.length])
                                .range([0,race_tabs.attr("width")]);
            
            for (i=0; i<race_list.length; i++){
                var rect;
                var text;
                
                // Add Rectangles
                rect = race_tabs.append("rect")
                            .attr("id", race_list[i])
                            .attr("x",tabsScale(i))
                            .attr("y",5)
                            .attr("width",100)
                            .attr("height",40)
                            .style("fill", "red")
                // Overlay Text
                text = race_tabs.append("text")
                            .attr("x", tabsScale(i))
                            .attr("y", 25)
                            .attr("text-anchor", "start")
                            .attr("alignment-baseline", "central")
                            .style("font-size", "15pt")
                            .text(race_list[i]);
                
                buttons.push(rect);
            }
            
            
            // Add event Listeners
            buttons.forEach(function (b) {
                b.on("mouseover", function(){
                    console.log("hi")
                    b.style("fill", "blue")
                });
                
                b.on("mouseout", function(){
                    b.style("fill", "red")
                });
                
                b.on("click", function(){
                    //initializeRace
                })
            });
            
            
            
        </script>        
    </body>
</html>